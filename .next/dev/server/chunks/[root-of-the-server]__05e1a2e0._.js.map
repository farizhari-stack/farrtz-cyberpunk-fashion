{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/DownloadChrome/copy-of-farrtz-cyberpunk-fashion-next-update-cap-2/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\r\n\r\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\r\n\r\nexport const prisma =\r\n  globalForPrisma.prisma ||\r\n  new PrismaClient({\r\n    log: ['query'],\r\n  });\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,sMAAY,CAAC;IACf,KAAK;QAAC;KAAQ;AAChB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///D:/DownloadChrome/copy-of-farrtz-cyberpunk-fashion-next-update-cap-2/app/api/messages/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nexport async function GET() {\r\n    try {\r\n        const conversations = await prisma.chatConversation.findMany({\r\n            include: { messages: true }\r\n        });\r\n        return NextResponse.json(conversations);\r\n    } catch (error) {\r\n        return NextResponse.json({ error: 'Error fetching messages' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    try {\r\n        const json = await request.json();\r\n\r\n        // Find or create conversation\r\n        let conversation = await prisma.chatConversation.findUnique({\r\n            where: { userId: json.userId }\r\n        });\r\n\r\n        if (!conversation) {\r\n            conversation = await prisma.chatConversation.create({\r\n                data: {\r\n                    userId: json.userId,\r\n                    userName: json.userName || 'User',\r\n                    userEmail: '',\r\n                    unreadCount: json.sender === 'user' ? 1 : 0\r\n                }\r\n            });\r\n        } else {\r\n            await prisma.chatConversation.update({\r\n                where: { userId: json.userId },\r\n                data: {\r\n                    unreadCount: json.sender === 'user' ? (conversation.unreadCount + 1) : 0,\r\n                    lastMessageTime: new Date()\r\n                }\r\n            });\r\n        }\r\n\r\n        const message = await prisma.chatMessage.create({\r\n            data: {\r\n                userId: json.userId,\r\n                conversationId: json.userId,\r\n                userName: json.userName || conversation.userName,\r\n                message: json.message,\r\n                sender: json.sender,\r\n                read: json.sender === 'admin'\r\n            }\r\n        });\r\n\r\n        return NextResponse.json(message);\r\n    } catch (error) {\r\n        console.error(error);\r\n        return NextResponse.json({ error: 'Error sending message' }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,eAAe;IAClB,IAAI;QACA,MAAM,gBAAgB,MAAM,yHAAM,CAAC,gBAAgB,CAAC,QAAQ,CAAC;YACzD,SAAS;gBAAE,UAAU;YAAK;QAC9B;QACA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAO;QACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA0B,GAAG;YAAE,QAAQ;QAAI;IACjF;AACJ;AAEO,eAAe,KAAK,OAAgB;IACvC,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAE/B,8BAA8B;QAC9B,IAAI,eAAe,MAAM,yHAAM,CAAC,gBAAgB,CAAC,UAAU,CAAC;YACxD,OAAO;gBAAE,QAAQ,KAAK,MAAM;YAAC;QACjC;QAEA,IAAI,CAAC,cAAc;YACf,eAAe,MAAM,yHAAM,CAAC,gBAAgB,CAAC,MAAM,CAAC;gBAChD,MAAM;oBACF,QAAQ,KAAK,MAAM;oBACnB,UAAU,KAAK,QAAQ,IAAI;oBAC3B,WAAW;oBACX,aAAa,KAAK,MAAM,KAAK,SAAS,IAAI;gBAC9C;YACJ;QACJ,OAAO;YACH,MAAM,yHAAM,CAAC,gBAAgB,CAAC,MAAM,CAAC;gBACjC,OAAO;oBAAE,QAAQ,KAAK,MAAM;gBAAC;gBAC7B,MAAM;oBACF,aAAa,KAAK,MAAM,KAAK,SAAU,aAAa,WAAW,GAAG,IAAK;oBACvE,iBAAiB,IAAI;gBACzB;YACJ;QACJ;QAEA,MAAM,UAAU,MAAM,yHAAM,CAAC,WAAW,CAAC,MAAM,CAAC;YAC5C,MAAM;gBACF,QAAQ,KAAK,MAAM;gBACnB,gBAAgB,KAAK,MAAM;gBAC3B,UAAU,KAAK,QAAQ,IAAI,aAAa,QAAQ;gBAChD,SAAS,KAAK,OAAO;gBACrB,QAAQ,KAAK,MAAM;gBACnB,MAAM,KAAK,MAAM,KAAK;YAC1B;QACJ;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC/E;AACJ"}}]
}